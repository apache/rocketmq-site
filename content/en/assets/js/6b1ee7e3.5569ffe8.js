"use strict";(self.webpackChunkrocketmq_docs=self.webpackChunkrocketmq_docs||[]).push([[1750],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=n.createContext({}),l=function(e){var t=n.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=l(e.components);return n.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=l(a),m=r,h=d["".concat(u,".").concat(m)]||d[m]||p[m]||s;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var l=2;l<s;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},54572:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const s={},o="MessageQueue",i={unversionedId:"\u9886\u57df\u6a21\u578b/03messagequeue",id:"version-5.0/\u9886\u57df\u6a21\u578b/03messagequeue",title:"MessageQueue",description:"This section describes the definition, model relationship, and internal attributes of message queues in Apache RocketMQ. This topic also provides version compatibility information and usage notes for message queues.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-5.0/03-\u9886\u57df\u6a21\u578b/03messagequeue.md",sourceDirName:"03-\u9886\u57df\u6a21\u578b",slug:"/\u9886\u57df\u6a21\u578b/03messagequeue",permalink:"/en/docs/\u9886\u57df\u6a21\u578b/03messagequeue",draft:!1,editUrl:"https://github.com/apache/rocketmq-site/tree/new-official-website/versioned_docs/version-5.0/03-\u9886\u57df\u6a21\u578b/03messagequeue.md",tags:[],version:"5.0",frontMatter:{},sidebar:"version-5.0/myAutogeneratedSidebar",previous:{title:"Topic",permalink:"/en/docs/\u9886\u57df\u6a21\u578b/02topic"},next:{title:"Message",permalink:"/en/docs/\u9886\u57df\u6a21\u578b/04message"}},u={},l=[{value:"Definition",id:"definition",level:2},{value:"Model relationship",id:"model-relationship",level:2},{value:"Internal attributes",id:"internal-attributes",level:2},{value:"Behavior constraints",id:"behavior-constraints",level:2},{value:"Version compatibility",id:"version-compatibility",level:2},{value:"Usage notes",id:"usage-notes",level:2}],c={toc:l};function p(e){let{components:t,...s}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"messagequeue"},"MessageQueue"),(0,r.kt)("p",null,"This section describes the definition, model relationship, and internal attributes of message queues in Apache RocketMQ. This topic also provides version compatibility information and usage notes for message queues."),(0,r.kt)("h2",{id:"definition"},"Definition"),(0,r.kt)("p",null,"A queue is a container that is used to store and transmit messages in Apache RocketMQ. A queue is the smallest unit of storage for Apache RocketMQ messages."),(0,r.kt)("p",null,"A topic in Apache RocketMQ consists of multiple queues. This way, queues support horizontal partitioning and streaming storage."),(0,r.kt)("p",null,"Queues provide the following benefits:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Ordered storageQueues are ordered in nature. Messages are stored in the same order in which they are queued. The earliest message is at the start of the queue and the latest message is at the end of the queue. Offsets are used to label the locations and the order of messages in a queue.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Streaming operation semanticsThe queue-based storage in Apache RocketMQ allows consumers to read one or more messages from an offset. This helps implement features such as aggregate read and backtrack read. These features are not available in RabbitMQ or ActiveMQ."))),(0,r.kt)("h2",{id:"model-relationship"},"Model relationship"),(0,r.kt)("p",null,"The following figure shows the position of queues in the domain model of Apache RocketMQ.",(0,r.kt)("img",{alt:"\u961f\u5217",src:a(35838).Z,width:"2358",height:"920"})),(0,r.kt)("p",null,"By default, Apache RocketMQ provides reliable message storage. All messages that are successfully delivered are persistently stored in queues. Messages are sent by the producer and received by the consumer client. Each message can be successfully delivered at least once."),(0,r.kt)("p",null,"The queue model of Apache RocketMQ is similar to the partition model of Kafka. In Apache RocketMQ, a queue is part of a topic. Messages are operated in queues even though they are managed by topic. For example, when a producer sends a message to a specific topic, the message is sent to a queue in the topic."),(0,r.kt)("p",null,"You can change the number of queues in Apache RocketMQ to scale out or scale in."),(0,r.kt)("h2",{id:"internal-attributes"},"Internal attributes"),(0,r.kt)("p",null,"Read and write permissions"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Definition: whether data can be read from or written to the current queue.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Values: defined by the broker. The following describes the enumerations:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"6: read and write. Messages can be written to and read from the current queue.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"4: read-only. Messages can be read from but not written to the current queue.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"2: write-only. Messages can be written to but not read from the current queue.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"0: The read or write status is unavailable. The current queue does not allow read or write operations."))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Constraint: The read and write permissions are related to O\\&M operations. We recommend that you do not frequently modify the permissions.")),(0,r.kt)("h2",{id:"behavior-constraints"},"Behavior constraints"),(0,r.kt)("p",null,"Each topic consists of one or more queues that are used to store messages. The number of queues in each topic is related to the message type and the region where the instance resides. The number of queues cannot be changed."),(0,r.kt)("h2",{id:"version-compatibility"},"Version compatibility"),(0,r.kt)("p",null,"Queue names vary based on the versions of Apache RocketMQ brokers. The following describes the differences:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Broker versions 3.x and 4.x: A queue name consists of the topic name, broker ID, and queue ID, and is bound to physical nodes.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Broker versions 5.x: A queue name is a globally unique string that is assigned by the cluster, and is decoupled from physical nodes."))),(0,r.kt)("p",null,"We recommend that you do not construct queue names or bind them to other operations. Otherwise, the queue names may fail to be resolved when the broker is updated."),(0,r.kt)("h2",{id:"usage-notes"},"Usage notes"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Queue number setting")),(0,r.kt)("p",null,"You can specify the number of queues in Apache RocketMQ when you create or change a topic. We recommend that you configure a small number of queues and avoid adding queues that you do not require."),(0,r.kt)("p",null,"The following describes the issues that occur due to a large number of queues in a topic:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Increase in the volume of metadata in a cluster")," Apache RocketMQ collects metrics and monitors data based on queues. A large number of queues may cause the volume of metadata to increase.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Overloaded client")," Message reads and writes in Apache RocketMQ are performed based on queues. A large number of queues may generate empty polling requests that increase system load.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Scenarios for adding queues")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Load balancing of physical nodes"),(0,r.kt)("p",{parentName:"li"},"Queues of each topic in Apache RocketMQ can be distributed to different service nodes. To ensure the load balancing of cluster traffic after the cluster is scaled out, we recommend that you add queues or migrate previous queues to the new service nodes."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Performance bottleneck issue related to fifo messages"),(0,r.kt)("p",{parentName:"li"},"In Apache RocketMQ broker versions 4.x, fifo messages take effect in only queues. As a result, the concurrency of fifo messages is based on the number of queues. We recommend that you increase the number of queues when a performance bottleneck issue occurs in the system."))))}p.isMDXComponent=!0},35838:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/archiforqueue-dd6788b33bf2fc96b4a1dab83a1b0d71.png"}}]);