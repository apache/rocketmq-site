"use strict";(self.webpackChunkrocketmq_docs=self.webpackChunkrocketmq_docs||[]).push([[4885],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>d});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},s=Object.keys(e);for(o=0;o<s.length;o++)r=s[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var u=o.createContext({}),l=function(e){var t=o.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return o.createElement(u.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,s=e.originalType,u=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),p=l(r),d=n,h=p["".concat(u,".").concat(d)]||p[d]||m[d]||s;return r?o.createElement(h,i(i({ref:t},c),{},{components:r})):o.createElement(h,i({ref:t},c))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=r.length,i=new Array(s);i[0]=p;var a={};for(var u in t)hasOwnProperty.call(t,u)&&(a[u]=t[u]);a.originalType=e,a.mdxType="string"==typeof e?e:n,i[1]=a;for(var l=2;l<s;l++)i[l]=r[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}p.displayName="MDXCreateElement"},66424:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var o=r(87462),n=(r(67294),r(3905));const s={},i="ConsumerGroup",a={unversionedId:"domainModel/07consumergroup",id:"version-5.0/domainModel/07consumergroup",title:"ConsumerGroup",description:"This section describes the definition, model relationship, internal attributes, and behavior constraints of consumer groups in Apache RocketMQ. This topic also provides version compatibility information and usage notes for consumer groups.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-5.0/03-domainModel/07consumergroup.md",sourceDirName:"03-domainModel",slug:"/domainModel/07consumergroup",permalink:"/docs/domainModel/07consumergroup",draft:!1,editUrl:"https://github.com/apache/rocketmq-site/tree/new-official-website/versioned_docs/version-5.0/03-domainModel/07consumergroup.md",tags:[],version:"5.0",frontMatter:{},sidebar:"version-5.0/myAutogeneratedSidebar",previous:{title:"Producer",permalink:"/docs/domainModel/04producer"},next:{title:"Consumer",permalink:"/docs/domainModel/08consumer"}},u={},l=[{value:"Definition",id:"definition",level:2},{value:"Model relationship",id:"model-relationship",level:2},{value:"Internal attributes",id:"internal-attributes",level:2},{value:"Behavior constraints",id:"behavior-constraints",level:2},{value:"Version compatibility",id:"version-compatibility",level:2},{value:"Usage notes",id:"usage-notes",level:2}],c={toc:l};function m(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,o.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"consumergroup"},"ConsumerGroup"),(0,n.kt)("p",null,"This section describes the definition, model relationship, internal attributes, and behavior constraints of consumer groups in Apache RocketMQ. This topic also provides version compatibility information and usage notes for consumer groups."),(0,n.kt)("h2",{id:"definition"},"Definition"),(0,n.kt)("p",null,"A consumer group is a load balancing group that contains consumers that use the same consumption behaviors in Apache RocketMQ."),(0,n.kt)("p",null,"Unlike consumers that are running entities, consumer groups are logical resources. Apache RocketMQ initializes multiple consumers in a consumer group to achieve the scaling of consumption performance and high availability disaster recovery."),(0,n.kt)("p",null,"In a consumer group, consumers consume messages based on the consumption behaviors and load balancing policy that are defined in the group. The following section describes the consumption behaviors that are defined:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Subscription: Apache RocketMQ manages and traces subscriptions based on consumer groups. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/domainModel/09subscription"},"Subscriptions"),".\naa")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Delivery order: The Apache RocketMQ broker delivers messages to consumers by using ordered delivery or concurrent delivery. You can configure the delivery method in the consumer group. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/featureBehavior/03fifomessage"},"fifo messages"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Consumption retry policy: the retry policy that is used when a consumer fails to consume a message. The policy includes the number of retries and the setting of dead-letter queues. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/featureBehavior/10consumerretrypolicy"},"Consumption retry"),"."))),(0,n.kt)("h2",{id:"model-relationship"},"Model relationship"),(0,n.kt)("p",null,"The following figure shows the position of consumer groups in the domain model of Apache RocketMQ.",(0,n.kt)("img",{alt:"Consumer groups",src:r(97437).Z,width:"1977",height:"877"})),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"The message is initialized by the producer and sent to the Apache RocketMQ server.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Messages are stored in the specified queue of the topic in the order in which they arrive at the Apache RocketMQ server.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"The consumer obtains and consumes messages from the Apache RocketMQ server based on the specified subscription relationship."))),(0,n.kt)("h2",{id:"internal-attributes"},"Internal attributes"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Consumer group name")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Definition: the name of a consumer group. Consumer group names are used to distinguish between consumer groups. Consumer group names are globally unique in a cluster.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Values: created and configured by users. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/introduction/03limits"},"Parameter limits"),"."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Delivery order")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Definition: the order in which Apache RocketMQ delivers messages to a consumer client."),(0,n.kt)("p",{parentName:"li"},"Apache RocketMQ supports ordered delivery and concurrent delivery based on different consumption scenarios. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/featureBehavior/03fifomessage"},"Fifo messages"),"."))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Values: The default delivery method is concurrent delivery.")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Consumption retry policy")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Definition: the retry policy that is used when a consumer fails to consume a message. If a consumer fails to consume a message, the system re-delivers the failed message to the consumer for re-consumption based on the policy. For more information, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/featureBehavior/10consumerretrypolicy"},"Consumption retry"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Values:A consumption retry policy contains the following items:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Maximum retries: the maximum number of times that a message can be re-delivered. If a message fails to be consumed and the maximum number of retries is exceeded, the message is delivered to the dead-letter queue or is discarded.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Retry interval: the interval between which the Apache RocketMQ broker re-delivers a failed message."))))),(0,n.kt)("p",null,"For more information about the valid values and default values of maximum retries and retry intervals, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/introduction/03limits"},"Parameter limits"),"."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Constraint: Retry interval is available only for push consumers.")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Subscription")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Definition: the set of subscription relationships that are associated with the current consumer group. A subscription includes the topics to which the consumers subscribe and the message filter rules that are used by consumers. For more information, see ",(0,n.kt)("a",{parentName:"li",href:"/docs/domainModel/09subscription"},"Subscriptions"),".")),(0,n.kt)("p",null,"Consumers dynamically register subscriptions for consumer groups. The Apache RocketMQ broker persists subscriptions and matches the subscriptions to the consumption progress of messages."),(0,n.kt)("h2",{id:"behavior-constraints"},"Behavior constraints"),(0,n.kt)("p",null,"In the Apache RocketMQ domain model, consumer management is implemented through consumer grouping, and consumers in the same group share messages for consumption. Therefore, to ensure the normal load and consumption of messages in a group, Apache RocketMQ require all consumers in the same group to keep the following consumption behaviors consistent:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Delivery Order"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Consumption retry policy")))),(0,n.kt)("h2",{id:"version-compatibility"},"Version compatibility"),(0,n.kt)("p",null,"As described in Behavior Constraints, the delivery order and consumption retry policy of all consumers in the same group need to be consistent."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Apache RocketMQ server version 5.x: The consumption behavior of the preceding consumers is obtained from the associated consumer groups. Therefore, the consumption behavior of all consumers in the same group must be consistent, and the client does not need to pay attention to it.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Apache RocketMQ server version 3.x/ 4.x history: The preceding consumption logic is defined by the consumer client interface. Therefore, you must ensure that the consumption behavior of consumers in the same group is consistent when you set the consumer client."))),(0,n.kt)("p",null,"If you use the Apache RocketMQ server version 5.x and the client uses the previous version SDK, the consumer's consumption logic is subject to the settings of the consumer client interface."),(0,n.kt)("h2",{id:"usage-notes"},"Usage notes"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Create consumer groups based on your business requirements")),(0,n.kt)("p",null,"In Apache RocketMQ, consumers and topics are in a many-to-many mapping relationship. We recommend that you take note of the following rules before you create consumer groups:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Consistent message delivery order: The message delivery order must be consistent for all consumers in a consumer group. The delivery method is either ordered delivery or concurrent delivery. We recommend that you do not use the same consumer group for different business scenarios.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Consistent business type: A consumer group corresponds to a topic. Different business domains have different requirements for message consumption, such as message filter rules and consumption retry policies. We recommend that you use different consumer groups in different business domains. We also recommend that you add up to 10 topics in a consumer group."))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Avoid using automated mechanisms to manage consumer groups")),(0,n.kt)("p",null,"In the Apache RocketMQ architecture, consumer groups are logical resources that are used to manage the status of consumers. Each consumer group is associated with various data, such as consumption status, accumulated messages, observable metrics, and monitoring data. We recommend that you strictly manage your consumer groups. Proceed with caution when you add, delete, modify, or query consumption groups."),(0,n.kt)("p",null,"Apache RocketMQ provides the automatic consumer group creation feature. However, if you enable this feature in production environments, a large number of consumer groups may be created. A large number of consumer groups can be difficult to manage and reclaim and results in the waste of system resources. Therefore, we recommend that you use this feature in only test environments."))}m.isMDXComponent=!0},97437:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/archiforconsumergroup-9d98f4f7fc0302aa2363454a552477d9.png"}}]);