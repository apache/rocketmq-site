<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-5.0 plugin-docs plugin-id-default docs-doc-id-observability/01metrics">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Metrics | RocketMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/observability/01metrics"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="5.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-5.0"><meta data-rh="true" name="docsearch:version" content="5.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-5.0"><meta data-rh="true" property="og:title" content="Metrics | RocketMQ"><meta data-rh="true" name="description" content="RocketMQ exposes the following metrics in Prometheus format. You can monitor your clusters with those metrics."><meta data-rh="true" property="og:description" content="RocketMQ exposes the following metrics in Prometheus format. You can monitor your clusters with those metrics."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/observability/01metrics"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/zh/docs/observability/01metrics" hreflang="zh"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/observability/01metrics" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/observability/01metrics" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://R2IYF7ETH7-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RocketMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RocketMQ Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="RocketMQ" href="/opensearch.xml">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?36428f2b841d08e7405724cbf7f860d2";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-89603173-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="alternate" type="application/rss+xml" href="/events/rss.xml" title="RocketMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/events/atom.xml" title="RocketMQ Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/release-notes/rss.xml" title="RocketMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/release-notes/atom.xml" title="RocketMQ Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="RocketMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="RocketMQ Atom Feed">

<link rel="stylesheet" href="//g.alicdn.com/mamba/assets/0.0.13/mse-arc-ui.min.css">
<script src="//g.alicdn.com/mamba/assets/0.0.13/mse-arc-ui.min.js"></script><link rel="stylesheet" href="/assets/css/styles.30209d89.css">
<link rel="preload" href="/assets/js/runtime~main.8de30a35.js" as="script">
<link rel="preload" href="/assets/js/main.53476ade.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Apache_RocketMQ_logo.svg.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Apache_RocketMQ_logo.svg.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apache RocketMQ</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/rocketmq" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/zh/docs/observability/01metrics" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/docs/observability/01metrics" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">5.0</a></li><li><a class="dropdown__link" href="/docs/4.x/">4.x</a></li></ul></div><a class="navbar__item navbar__link" href="/download">Download</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog">User Cases</a></li><li><a class="dropdown__link" href="/events">Activity</a></li><li><a class="dropdown__link" href="/release-notes">Change Log</a></li><li><a class="dropdown__link" href="/news">RocketMQ News</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contact">Join Community</a></li><li><a class="dropdown__link" href="/origin">Origin</a></li><li><a class="dropdown__link" href="/team">Teams</a></li><li><a class="dropdown__link" href="/docs/contributionGuide/01how-to-contribute">Contributions</a></li><li><a class="dropdown__link" href="/enterprise">Enterprises</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/quickStart/01quickstart">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/domainModel/01main">Domain Model</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/featureBehavior/01normalmessage">Feature Behavior</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/deploymentOperations/01deploy">Deployment &amp; Operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/observability/01metrics">Observability</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/observability/01metrics">Metrics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/sdk/01overview">Client SDK</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bestPractice/01bestpractice">Best Practice</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/eventbridge/01RocketMQEventBridgeConcepts">RocketMQ EventBridge</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/mqtt/01RocketMQMQTTOverview">RocketMQ MQTT</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/connect/01RocketMQ Connect Overview">RocketMQ Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/streams/01RocketMQ Streams Overview">RocketMQ Streams</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/contributionGuide/01how-to-contribute">Contribution Guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Observability</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Metrics</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 5.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Metrics</h1><p>RocketMQ exposes the following metrics in Prometheus format. You can monitor your clusters with those metrics.</p><ul><li>Broker metrics</li><li>Producer metrics</li><li>Consumer metrics</li></ul><blockquote><p>Version support: The following metrics for RocketMQ were introduced since 5.1.0 and only support the broker.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="details-of-metrics">Details of metrics<a href="#details-of-metrics" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metric-types">Metric types<a href="#metric-types" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The standard for defining metrics in RocketMQ complies with that for defining the metrics in open source Prometheus. The metric types that RocketMQ offers include counters, gauges, and histograms. For more information, see <a href="https://prometheus.io/docs/concepts/metric_types/" target="_blank" rel="noopener noreferrer">METRIC TYPES</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="broker-metrics">Broker metrics<a href="#broker-metrics" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The following table describes the labels of the metrics that are related to the Message Queue for Apache RocketMQ broker.</p><ul><li>cluster: RocketMQ cluster name.</li><li>node_type: the type of service node, whitch includes the following:proxy,broker,nameserver.</li><li>node_id: the ID of the service node.</li><li>topic: the topic of RocketMQ.</li><li>message_type: the type of a message, which includes the following:<br>normal:normal messages;<br>fifo:ordered messages;<br>transaction:Transactional messages;<br>delay:scheduled or delayed messages.</li><li>consumer_group: the ID of the consumer group.</li></ul><table><thead><tr><th>Type</th><th>Name</th><th>Unit</th><th>Description</th><th>Label</th></tr></thead><tbody><tr><td>counter</td><td>rocketmq_messages_in_total</td><td>count</td><td>The number of messages that are produced.</td><td>cluster,node_type,node_id,topic,message_type</td></tr><tr><td>counter</td><td>rocketmq_messages_out_total</td><td>count</td><td>The number of messages that are consumed.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>counter</td><td>rocketmq_throughput_in_total</td><td>byte</td><td>The write throughput that are produced.</td><td>cluster,node_type,node_id,topic,message_type</td></tr><tr><td>counter</td><td>rocketmq_throughput_out_total</td><td>byte</td><td>The read throughput that are produced.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>histogram</td><td>rocketmq_message_size</td><td>byte</td><td>The distribution of message sizes. This metric is counted only when messages are sent. The following shows the distribution ranges:<br>le_1_kb: ≤ 1 KB<br> le_4_kb: ≤ 4 KB<br>le_512_kb: ≤ 512 KB<br>le_1_mb: ≤ 1 MB<br>le_2_mb: ≤ 2 MB<br>le_4_mb: ≤ 4 MB<br>le_overflow: &gt; 4 MB</td><td>cluster,node_type,node_id,topic,message_type</td></tr><tr><td>gauge</td><td>rocketmq_consumer_ready_messages</td><td>count</td><td>The number of ready messages.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>gauge</td><td>rocketmq_consumer_inflight_messages</td><td>count</td><td>The number of inflight messages.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>gauge</td><td>rocketmq_consumer_queueing_latency</td><td>millisecond</td><td>Ready messages queueing delay time.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>gauge</td><td>rocketmq_consumer_lag_latency</td><td>millisecond</td><td>The delayed time before messages are consumed.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>counter</td><td>rocketmq_send_to_dlq_messages_total</td><td>count</td><td>The number of messages that are sent to the dead-letter queue.</td><td>cluster,node_type,node_id,topic, consumer_group</td></tr><tr><td>histogram</td><td>rocketmq_rpc_latency</td><td>millisecond</td><td>The rpc call latency</td><td>cluster,node_typ,node_id,protocol_type,request_code,response_code</td></tr><tr><td>gauge</td><td>rocketmq_storage_message_reserve_time</td><td>millisecond</td><td>Message retention time.</td><td>cluster,node_type,node_id</td></tr><tr><td>gauge</td><td>rocketmq_storage_dispatch_behind_bytes</td><td>byte</td><td>Undispatched message size.</td><td>cluster,node_type,node_id</td></tr><tr><td>gauge</td><td>rocketmq_storage_flush_behind_bytes</td><td>byte</td><td>Unflushed messsage size.</td><td>cluster,node_type,node_id</td></tr><tr><td>gauge</td><td>rocketmq_thread_pool_wartermark</td><td>count</td><td>The number of tasks queued in the thread pool.</td><td>cluster,node_type,node_id,name</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="producer-metrics">Producer metrics<a href="#producer-metrics" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The following table describes the labels of the metrics that are related to the producers in Message Queue for Apache RocketMQ.</p><ul><li>cluster: RocketMQ cluster name.</li><li>node_type: the type of service node, whitch includes the following:proxy,broker,nameserver.</li><li>node_id: the ID of the service node.</li><li>topic: the topic of Message Queue for Apache RocketMQ.</li><li>message_type: the type of a message, which includes the following:<br>normal:normal messages;<br>fifo:ordered messages;<br>transaction:Transactional messages;<br>delay:scheduled or delayed messages.</li><li>client_id: the ID of the client.</li><li>invocation_status: the result of the API call for sending messages, which includes success and failure.</li></ul><table><thead><tr><th>Type</th><th>Name</th><th>Unit</th><th>Description</th><th>Label</th></tr></thead><tbody><tr><td>Histogram</td><td>rocketmq_send_cost_time</td><td>millisecond</td><td>The distribution of production API call time. The following shows the distribution ranges: <br>le_1_ms <br>le_5_ms<br>le_10_ms<br>le_20_ms <br>le_50_ms <br>le_200_ms<br>le_500_ms <br>le_overflow</td><td>topic,client_id,invocation_status</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consumer-metrics">Consumer metrics<a href="#consumer-metrics" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The following table describes the labels of the metrics that are related to the consumers in Message Queue for Apache RocketMQ.</p><ul><li>topic: the topic of Message Queue for Apache RocketMQ.</li><li>consumer_group: the ID of the consumer group.</li><li>client_id: the ID of the client.</li><li>invocation_status: the result of the API call for sending messages, which includes success and failure.</li></ul><table><thead><tr><th>Type</th><th>Name</th><th>Unit</th><th>Description</th><th>Label</th></tr></thead><tbody><tr><td>Histogram</td><td>rocketmq_process_time</td><td>millisecond</td><td>The distribution of message process time.The following shows the distribution ranges: <br>le_1_ms <br>le_5_ms  <br>le_10_ms<br>le_100_ms <br>le_10000_ms<br>le_60000_ms <br>le_overflow</td><td>topic,consumer_group,client_id,invocation_status</td></tr><tr><td>gauge</td><td>rocketmq_consumer_cached_messages</td><td>message</td><td>The number of messages in the local buffer queue of PushConsumer.</td><td>topic,consumer_group,client_id</td></tr><tr><td>gauge</td><td>rocketmq_consumer_cached_bytes</td><td>byte</td><td>The total size of messages in the local buffer queue of PushConsumer.</td><td>topic,consumer_group,client_id</td></tr><tr><td>Histogram</td><td>rocketmq_await_time</td><td>millisecond</td><td>The distribution of queuing time for messages in the local buffer queue of PushConsumer. The following shows the distribution ranges:<br>le_1_ms<br> le_5_ms<br>le_20_ms<br>le_100_ms <br>le_1000_ms<br> le_5000_ms <br>le_10000_ms<br>le_overflow</td><td>topic,consumer_group,client_id</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="background-information">Background information<a href="#background-information" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>RocketMQ defines metrics based on the following business scenarios.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="message-accumulation-scenarios">Message accumulation scenarios<a href="#message-accumulation-scenarios" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="rocketmq queue meesage stuatus" src="/assets/images/message-accumulation-4a033c0e12019e8da39e570e02247318.png" width="851" height="243" class="img_ev3q"><br>The above figure shows the number and duration of messages in different stages. By monitoring these metrics, you can determine whether the business consumption is abnormal. The following table describes the meaning of these metrics and the formulas that are used to calculate these metrics.</p><table><thead><tr><th>Name</th><th>Description</th><th>Formula</th></tr></thead><tbody><tr><td>Inflight messages</td><td>The number of messages being processed by consumer but not acked yet</td><td>Offset of the latest pulled message - Offset of the latest committed message</td></tr><tr><td>Ready messages</td><td>The number of messages that are ready for consumption.</td><td>Maximum offset - Offset of the latest pulled message</td></tr><tr><td>Ready time</td><td>normal message or ordered message:the time when the message is stored to the broker.  <br> Scheduled message:timing end time. <br>  Transactional message: transaction commit time.</td><td>--</td></tr><tr><td>Ready message queue time</td><td>The time interval between the ready time of the earliest ready message and the current time. This time reflects the timeliness of consumers pulling messages.</td><td>Current time - Ready time of the earliest ready message</td></tr><tr><td>Consumer lag time</td><td>The time difference between the ready time of the earliest unacked message and the current moment.<br>This time reflects the timeliness of the consumer to complete message processing.</td><td>Current time - Ready time of the earliest unacked message</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pushconsumer-consumption-scenarios">PushConsumer consumption scenarios<a href="#pushconsumer-consumption-scenarios" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>In PushConsumer, real-time message processing capability is implemented based on the typical Reactor thread model inside the SDK.As shown below, the SDK has a built-in long polling thread that asynchronously pulls messages into the SDK&#x27;s built-in buffer queue and then separately commits them to the consumer thread, triggering the listener to execute the local consumption logic.<br><img loading="lazy" alt="PushConsumer client" src="/assets/images/pushconsumer-consumption-1e24bd7ab8e28a1f165635bd5a49637f.png" width="681" height="321" class="img_ev3q"><br>The metrics of local buffer queues in the PushConsumer scenario are as follows:</p><ul><li>Number of messages in the local buffer queue: Total number of messages in the local buffer queue.</li><li>Message size in the local buffer queue: The sum of all message sizes in the local buffer queue.</li><li>Message waiting time: the time that the message is temporarily cached in the local buffer queue waiting to be processed.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-obtain-metrics">How to Obtain Metrics<a href="#how-to-obtain-metrics" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Currently, two exporters are supported: gRPC OTLP and Prometheus.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grpc-otlp-exporter">gRPC OTLP Exporter<a href="#grpc-otlp-exporter" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The gRPC OTLP exporter periodically reports metrics to the specified OpenTelemetry Collector.</p><p>Prerequisites: Deploy an OpenTelemetry Collector that supports the <a href="https://github.com/open-telemetry/oteps/blob/main/text/0035-opentelemetry-protocol.md" target="_blank" rel="noopener noreferrer">GRPC OpenTelemetry Protocol</a>.</p><p>To enable the gRPC OTLP exporter of Broker metrics, do the following:</p><ol><li>Set <code>metricsExporterType</code> to <code>OTLP_GRPC</code>.</li><li>Set <code>getMetricsGrpcExporterTarget</code> to the endpoint provided by the OpenTelemetry Collector.</li></ol><p>Optional configurations:</p><ol><li><code>metricsGrpcExporterHeader</code>: Attach request headers to the gRPC OTLP exporter in the format of key1:value1,key2:value2.</li><li><code>metricGrpcExporterTimeOutInMills</code>: Set the request timeout for the gRPC OTLP exporter.</li><li><code>metricGrpcExporterIntervalInMills</code>: Set the reporting interval for the gRPC OTLP exporter.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prometheus-exporter">Prometheus Exporter<a href="#prometheus-exporter" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The Prometheus exporter only supports Pull mode and Cumulative aggregation. See <a href="https://opentelemetry.io/docs/reference/specification/metrics/sdk_exporters/prometheus/" target="_blank" rel="noopener noreferrer">OpenTelemetry Metrics Exporter - Prometheus</a> for more information.</p><p>To enable the Prometheus exporter of Broker metrics, do the following:</p><ol><li>Set <code>metricsExporterType</code> to <code>PROM</code>.</li></ol><p>Visit <code>http://&lt;broker-ip&gt;:5557/metrics</code> to view metrics. Configure service discovery or manually configure a pull task in Prometheus to collect metrics.</p><p>Optional configurations:</p><ol><li><code>metricsPromExporterPort</code>: The port number on which Broker exposes the metrics service. The default is <code>5557</code>.</li><li><code>metricGrpcExporterTimeOutInMills</code>: The hostname for the exposed metrics service. The default is the IP to which Broker registers with NameServer, brokerIP1.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/rocketmq-site/tree/new-official-website/versioned_docs/version-5.0/12-observability/01metrics.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/deploymentOperations/05Exporter"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RocketMQ Promethus Exporter</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/sdk/01overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#details-of-metrics" class="table-of-contents__link toc-highlight">Details of metrics</a><ul><li><a href="#metric-types" class="table-of-contents__link toc-highlight">Metric types</a></li><li><a href="#broker-metrics" class="table-of-contents__link toc-highlight">Broker metrics</a></li><li><a href="#producer-metrics" class="table-of-contents__link toc-highlight">Producer metrics</a></li><li><a href="#consumer-metrics" class="table-of-contents__link toc-highlight">Consumer metrics</a></li></ul></li><li><a href="#background-information" class="table-of-contents__link toc-highlight">Background information</a><ul><li><a href="#message-accumulation-scenarios" class="table-of-contents__link toc-highlight">Message accumulation scenarios</a></li><li><a href="#pushconsumer-consumption-scenarios" class="table-of-contents__link toc-highlight">PushConsumer consumption scenarios</a></li></ul></li><li><a href="#how-to-obtain-metrics" class="table-of-contents__link toc-highlight">How to Obtain Metrics</a><ul><li><a href="#grpc-otlp-exporter" class="table-of-contents__link toc-highlight">gRPC OTLP Exporter</a></li><li><a href="#prometheus-exporter" class="table-of-contents__link toc-highlight">Prometheus Exporter</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/domainModel/01main">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickStart/01quickstart">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/version">Migration from 4.x to 5.0</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/ApacheRocketMQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/rocketmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://github.com/apache/rocketmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/release-notes">Changelog</a></li><li class="footer__item"><a href="https://github.com/apache/rocketmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Licenses<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://rocketmq.apache.org/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/Apache_RocketMQ_logo.svg.png" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/Apache_RocketMQ_logo.svg.png" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 The Apache Software Foundation. Licensed under the Apache License, Version 2.0.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8de30a35.js"></script>
<script src="/assets/js/main.53476ade.js"></script>
</body>
</html>