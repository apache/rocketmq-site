<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Best Practice For NameServer - Apache RocketMQ</title>




<meta name="description" content="In Apache RocketMQ, name servers are designed to coordinate each component of the distributed systemand the coordination is mainly achieved through managing topic routing information.">




<meta property="og:locale" content="en">
<meta property="og:site_name" content="Apache RocketMQ">
<meta property="og:title" content="Best Practice For NameServer">




  <meta property="og:description" content="In Apache RocketMQ, name servers are designed to coordinate each component of the distributed systemand the coordination is mainly achieved through managing topic routing information.">



  <meta name="twitter:site" content="@ApacheRocketMQ">
  <meta name="twitter:title" content="Best Practice For NameServer">
  <meta name="twitter:description" content="In Apache RocketMQ, name servers are designed to coordinate each component of the distributed systemand the coordination is mainly achieved through managing topic routing information.">
  <meta name="twitter:url" content="">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-10-09T16:24:07+08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Apache RocketMQ",
      "url" : null,
      "sameAs" : null
    }
  </script>



  <meta name="google-site-verification" content="aand0XZkSGsziuC-UPD4ZJniFD0m0JhGx6820y2mAQY" />


  <meta name="baidu-site-verification" content="wD06EbDRkQ" />




<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Apache RocketMQ Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="/">Apache RocketMQ</a></li>
          
            
            <li class="masthead__menu-item"><a href="/docs/quick-start/">Documentation</a></li>
          
            
            <li class="masthead__menu-item"><a href="/year-archive/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="/community/">Community</a></li>
          
            
            <li class="masthead__menu-item"><a href="/users/">Users</a></li>
          
            
            <li class="masthead__menu-item"><a href="/about/team/">About</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">User Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/motivation/" class="">Why RocketMQ</a></li>
          
            
            

            
            

            <li><a href="/docs/quick-start/" class="">Quick Start</a></li>
          
            
            

            
            

            <li><a href="/docs/simple-example/" class="">Simple Example</a></li>
          
            
            

            
            

            <li><a href="/docs/order-example/" class="">Order Example</a></li>
          
            
            

            
            

            <li><a href="/docs/broadcast-example/" class="">Broadcasting Example</a></li>
          
            
            

            
            

            <li><a href="/docs/schedule-example/" class="">Schedule Example</a></li>
          
            
            

            
            

            <li><a href="/docs/batch-example/" class="">Batch Example</a></li>
          
            
            

            
            

            <li><a href="/docs/filter-by-sql92-example/" class="">Filter Example</a></li>
          
            
            

            
            

            <li><a href="/docs/logappender-example/" class="">Logappender Example</a></li>
          
            
            

            
            

            <li><a href="/docs/openmessaging-example/" class="">OpenMessaging Example</a></li>
          
            
            

            
            

            <li><a href="/docs/faq/" class="">FAQ</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Deployment & Operations</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/rmq-arc/" class="">Architecture</a></li>
          
            
            

            
            

            <li><a href="/docs/rmq-deployment/" class="">Deployment</a></li>
          
            
            

            
            

            <li><a href="/docs/cli-admin-tool/" class="">CLI Admin Tool</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Contributor Guide</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/how-to-contribute/" class="">How To Contribute</a></li>
          
            
            

            
            

            <li><a href="/docs/code-guidelines/" class="">Code Guidelines</a></li>
          
            
            

            
            

            <li><a href="/docs/pull-request/" class="">Manage Pull Request</a></li>
          
            
            

            
            

            <li><a href="/docs/release-manual" class="">Release Manual</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Best Practice</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/docs/core-concept/" class="">Core Concept</a></li>
          
            
            

            
            

            <li><a href="/docs/best-practice-broker/" class="">Broker</a></li>
          
            
            

            
            

            <li><a href="/docs/best-practice-producer/" class="">Producer</a></li>
          
            
            

            
            

            <li><a href="/docs/best-practice-consumer/" class="">Consumer</a></li>
          
            
            

            
            

            <li><a href="/docs/best-practice-namesvr/" class="active">NameServer</a></li>
          
            
            

            
            

            <li><a href="/docs/system-config/" class="">JVM/Kernel Config</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Release Notes</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/dowloading/releases/" class="">Download</a></li>
          
            
            

            
            

            <li><a href="/release_notes/release-notes-4.1.0-incubating/" class="">4.1.0-incubating</a></li>
          
            
            

            
            

            <li><a href="/release_notes/release-notes-4.0.0-incubating/" class="">4.0.0-incubating</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/docs/roadmap/"><span class="nav__sub-title">RoadMap</span></a>
        

        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Best Practice For NameServer">
    <meta itemprop="description" content="In Apache RocketMQ, name servers are designed to coordinate each component of the distributed systemand the coordination is mainly achieved through managing topic routing information.">
    <meta itemprop="datePublished" content="October 09, 2017">
    <meta itemprop="dateModified" content="December 25, 2016">

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Best Practice For NameServer
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>In Apache RocketMQ, name servers are designed to coordinate each component of the distributed system
and the coordination is mainly achieved through managing topic routing information.</p>

<aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#programmatic-way" id="markdown-toc-programmatic-way">Programmatic Way</a></li>
  <li><a href="#java-options" id="markdown-toc-java-options">Java Options</a></li>
  <li><a href="#environment-variable" id="markdown-toc-environment-variable">Environment Variable</a></li>
  <li><a href="#http-endpoint" id="markdown-toc-http-endpoint">HTTP Endpoint</a></li>
  <li><a href="#priority" id="markdown-toc-priority">Priority</a></li>
</ul>

  </nav>
</aside>

<p>Management consists of two parts:</p>
<ul>
  <li>Brokers periodically renew meta data kept in every name server.</li>
  <li>Name servers are serving clients, including producers, consumers and command line clients with the latest routing information.</li>
</ul>

<p>Therefore, before launching brokers and clients, we need to tell them how to reach name servers by feeding them with a name server address list.
In Apache RocketMQ, this can be done in four ways.</p>

<h2 id="programmatic-way">Programmatic Way</h2>

<p>For brokers, we can specify <code class="highlighter-rouge">namesrvAddr=name-server-ip1:port;name-server-ip2:port</code> in broker configuration file.</p>

<p>For producers and consumers, we can feed name server address list to them as follows:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">DefaultMQProducer</span> <span class="n">producer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultMQProducer</span><span class="o">(</span><span class="s">"please_rename_unique_group_name"</span><span class="o">);</span>
<span class="n">producer</span><span class="o">.</span><span class="na">setNamesrvAddr</span><span class="o">(</span><span class="s">"name-server1-ip:port;name-server2-ip:port"</span><span class="o">);</span>

<span class="n">DefaultMQPushConsumer</span> <span class="n">consumer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultMQPushConsumer</span><span class="o">(</span><span class="s">"please_rename_unique_group_name"</span><span class="o">);</span>
<span class="n">consumer</span><span class="o">.</span><span class="na">setNamesrvAddr</span><span class="o">(</span><span class="s">"name-server1-ip:port;name-server2-ip:port"</span><span class="o">);</span>
</code></pre>
</div>

<p>If you use admin command line from shell, you can also specify this way:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>sh mqadmin <span class="nb">command</span>-name -n name-server-ip1:port;name-server-ip2:port -X OTHER-OPTION
</code></pre>
</div>

<p>A simple example is:
<code class="highlighter-rouge">sh mqadmin -n localhost:9876 clusterList</code>
assuming to query cluster info on the name server node.</p>

<p>If you have integrated admin tool into your own dashboard, you can:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">DefaultMQAdminExt</span> <span class="n">defaultMQAdminExt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultMQAdminExt</span><span class="o">(</span><span class="s">"please_rename_unique_group_name"</span><span class="o">);</span>
<span class="n">defaultMQAdminExt</span><span class="o">.</span><span class="na">setNamesrvAddr</span><span class="o">(</span><span class="s">"name-server1-ip:port;name-server2-ip:port"</span><span class="o">);</span>
</code></pre>
</div>

<h2 id="java-options">Java Options</h2>

<p>Name server address list may also be fed to your application through specifying the sequel java option 
<code class="highlighter-rouge">rocketmq.namesrv.addr</code> before launching.</p>

<h2 id="environment-variable">Environment Variable</h2>

<p>You can export <code class="highlighter-rouge">NAMESRV_ADDR</code> environment variable. Brokers and clients will examine and use its value if set.</p>

<h2 id="http-endpoint">HTTP Endpoint</h2>

<p>If you do not specify name server address list using previously mentioned methods, Apache RocketMQ will access
 the following HTTP end point to acquire and update name server address list every two minutes with initial delay of
 ten seconds.</p>

<p>By default, the end point is:</p>

<p><code class="highlighter-rouge">http://jmenv.tbsite.net:8080/rocketmq/nsaddr</code></p>

<p>You may override <code class="highlighter-rouge">jmenv.tbsite.net</code> using this Java option: <code class="highlighter-rouge">rocketmq.namesrv.domain</code>,
You may also override <code class="highlighter-rouge">nsaddr</code> part using this Java option: <code class="highlighter-rouge">rocketmq.namesrv.domain.subgroup</code></p>

<p>If you are running Apache RocketMQ in production, this method is recommended because it gives you maximum flexibility
 – you can dynamically add or remove name server nodes without necessity of rebooting your brokers and clients 
 according to your name servers’ system load.</p>

<h2 id="priority">Priority</h2>

<p>Methods introduced first take precedence over the latter ones: <br />
<code class="highlighter-rouge">Programmatic Way &gt; Java Options &gt; Environment Variable &gt; HTTP Endpoint</code></p>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-12-25">December 25, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=ApacheRocketMQ&text=Best Practice For NameServer /docs/best-practice-namesvr/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=/docs/best-practice-namesvr/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=/docs/best-practice-namesvr/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=/docs/best-practice-namesvr/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/docs/create-pull-request/" class="pagination--pager" title="How to create Pull Request
">Previous</a>
    
    
      <a href="/docs/best-practice-producer/" class="pagination--pager" title="Best Practice For Producer
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <style type="text/css">
  div.columns   { float: left; margin-left: 10px;}
  div.clear     { clear: both; } 
</style>
<div>
  <div class="columns">
    <a href="https://www.apache.org/"><img src="/assets/images/feather-small.gif" alt="Apache Software Foundation" style="height: 88px !important" /></a>
  </div>
  <div class="columns" style="width: 80%">
    <div class="page__footer-follow">
      <ul class="social-icons">
        
          <li><strong>Follow:</strong></li>
        
        
          <li><a href="https://twitter.com/ApacheRocketMQ"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
        
        
          <li><a href="http://github.com/apache/incubator-rocketmq"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
        
        <li><a href="/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
      </ul>
    </div>

    <div class="page__footer-copyright">Copyright &copy; 2017 <a href="http://www.apache.org/">The Apache Software Foundation</a>. All Rights Reserved.</div>
  </div>
</div>
<div class="clear"></div>
      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89603173-1', 'auto');
  ga('send', 'pageview');
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?36428f2b841d08e7405724cbf7f860d2";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'rocketmq';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>
